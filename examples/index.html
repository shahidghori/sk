<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title></title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-mesh-particles-component@0.5.0/aframe-mesh-particles-component.js"></script>
    <script src="../src/index.js"></script>
  </head>
  <body>
    <a-scene background="color: grey" renderer="sortObjects: false">
      <a-assets>
        <a-asset-item id="fall" src="fall.glb"></a-asset-item>
        <a-asset-item id="winter" src="winter.glb"></a-asset-item>
        <a-asset-item id="spring" src="spring.glb"></a-asset-item>
        <a-asset-item id="transparent" src="transparent.glb"></a-asset-item>
        <a-asset-item id="leaf" src="leaf.glb"></a-asset-item>
      </a-assets>
      <!-- Camera Entity with WASD Controls -->
      <a-entity rotation="0 90 0">
        <a-camera position="0 1.2 0" wasd-controls="acceleration: 20" id="camera"></a-camera>
      </a-entity>

      <!-- Image portals -->
      <a-entity position="-3 1.2 0" rotation="0 90 0" image-portal="src: #fall"></a-entity>
      <a-entity position="0 1.2 -1" rotation="0 0 0" image-portal="src: #spring"></a-entity>
      <a-entity position="1 1.2 0" rotation="0 -90 0" image-portal="src: #winter"></a-entity>
      <a-entity position="0 1.2 1" rotation="0 180 0" image-portal="src: #transparent"></a-entity>

      <!-- Portal with leaf effect -->
      <a-entity position="0 1.2 0" rotation="0 0 0" id="leafPortal"
        geometry="primitive: plane; width: 2; height: 2;"
        material="src: #leaf; opacity: 0.5"
        class="clickable"
        event-set__mouseenter="_event: mouseenter; scale: 1.2 1.2 1.2"
        event-set__mouseleave="_event: mouseleave; scale: 1 1 1"
        cursor-listener></a-entity>

      <!-- Leaf Model with particle effect -->
      <a-gltf-model
        src="#leaf"
        scale="0.2 0.2 0.2"
        position="-3 4 0"
        rotation="90 0 0"
        mesh-particles="lifeTime: 1..8; spawnRate: 100; color: yellow,red; acceleration: 0 0 0; velocity: 0 0 1..0 0 5; radialVelocity: 0; radialPosition: 0.1..10; radialType: circle; rotation: 0 0 0,180 180 180;"
      ></a-gltf-model>
    </a-scene>

    <script>
      // Cursor event listener to move camera to leaf.glb location when the portal is clicked/tapped
      document.querySelector('#leafPortal').addEventListener('click', function () {
        var camera = document.querySelector('#camera');
        camera.setAttribute('position', '0 1.2 2');  // Position the camera inside the leaf portal
        camera.setAttribute('rotation', '0 180 0');  // Adjust the rotation if necessary
      });
    </script>
  </body>
</html>
